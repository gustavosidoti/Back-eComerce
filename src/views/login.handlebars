<h3>Login usuarios:</h3>

<form action="/api/sessions/login" method="post" id="loginForm">
    <input type="email" placeholder="ingrese se email" name="email" id="email">
    <input type="password" placeholder="ingrese su contraseña" name="password" id="password">
    <br><br>
    <input type="submit" value="Ingresar">
</form>

<br><br>
<p>¿no estas registrado? ingresa <a href="/register">aquí</a>...!!!</p>

<br>
<p>Tambien puedes acceder vía <a href="/api/sessions/github">Github</a></p>


<script>
    const form  = document.getElementById('loginForm');
    form.addEventListener('submit',evt=>{
        evt.preventDefault();
  
        const email = document.getElementById("email").value
        const password = document.getElementById("password").value
        const body = { email, password }
        console.log(body);
        fetch('/api/sessions/login',{
            method:'POST',
            body:JSON.stringify(body),
            headers: { 
                'Content-Type':'application/json'
            }
        }).then(result=>{
            return result.json()
        }).then(json=>{
            console.log(json);
            localStorage.setItem('token',json.token)
            document.cookie=`token=${json.token};max-age=3600`
            document.location.href=`/?token=${json.token}`;
        });
    })
</script>
